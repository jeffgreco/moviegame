<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Puzzle Builder</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
</head>
<body>
    <header>
        <h1>Puzzle Builder</h1>
        <nav class="main-nav">
            <button class="nav-btn active" data-view="builder">Builder</button>
            <button class="nav-btn" data-view="schedule">Schedule</button>
        </nav>
        <div id="api-status"></div>
    </header>

    <main id="builder-view" class="view-container">
        <aside class="search-panel">
            <h2>Search Movies</h2>

            <div class="search-tabs">
                <button class="tab-btn active" data-tab="title">Title</button>
                <button class="tab-btn" data-tab="director">Person</button>
                <button class="tab-btn" data-tab="discover">Browse</button>
                <button class="tab-btn" data-tab="ai">AI</button>
            </div>

            <!-- Title Search -->
            <div class="tab-content active" id="tab-title">
                <div class="form-group">
                    <label for="title-query">Movie Title</label>
                    <input type="text" id="title-query" placeholder="e.g. The Matrix">
                </div>
                <div class="form-group">
                    <label for="title-year">Year (optional)</label>
                    <input type="number" id="title-year" placeholder="e.g. 1999" min="1900" max="2030">
                </div>
                <button class="btn primary" id="btn-search-title">Search</button>
            </div>

            <!-- Person Search (Actor/Director) -->
            <div class="tab-content" id="tab-director">
                <div class="form-group">
                    <label for="director-query">Actor or Director</label>
                    <input type="text" id="director-query" placeholder="e.g. Tom Hanks, Greta Gerwig">
                </div>
                <button class="btn primary" id="btn-search-director">Search</button>

                <div id="director-results" class="director-list"></div>
            </div>

            <!-- Discover/Browse -->
            <div class="tab-content" id="tab-discover">
                <div class="form-group">
                    <label for="genre-select">Genre</label>
                    <select id="genre-select">
                        <option value="">All Genres</option>
                    </select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="year-from">From Year</label>
                        <input type="number" id="year-from" placeholder="1980" min="1900" max="2030">
                    </div>
                    <div class="form-group">
                        <label for="year-to">To Year</label>
                        <input type="number" id="year-to" placeholder="2024" min="1900" max="2030">
                    </div>
                </div>
                <button class="btn primary" id="btn-discover">Browse</button>
            </div>

            <!-- AI Search -->
            <div class="tab-content" id="tab-ai">
                <div class="form-group">
                    <label for="ai-prompt">Describe the movies you want</label>
                    <textarea id="ai-prompt" rows="4" placeholder="e.g. 90s action movies with car chases, or movies about musicians who become famous"></textarea>
                </div>
                <div class="form-group">
                    <label for="ai-count">Number of suggestions</label>
                    <select id="ai-count">
                        <option value="8">8 movies</option>
                        <option value="12" selected>12 movies</option>
                        <option value="16">16 movies</option>
                        <option value="20">20 movies</option>
                    </select>
                </div>
                <button class="btn primary" id="btn-ai-search">
                    <span class="btn-text">Search with AI</span>
                    <span class="btn-loading" style="display:none;">Thinking...</span>
                </button>
                <div id="ai-error" class="ai-error"></div>
            </div>
        </aside>

        <section class="results-panel">
            <div class="results-header">
                <h2>Search Results</h2>
                <span id="results-count"></span>
                <button class="btn" id="btn-ai-more" style="display: none;">+ More</button>
                <select id="person-sort" style="display: none;">
                    <option value="date_desc">Newest First</option>
                    <option value="date_asc">Oldest First</option>
                    <option value="popularity">Popularity</option>
                </select>
            </div>
            <div id="results-grid" class="movie-grid"></div>
            <div id="pagination" class="pagination"></div>
        </section>

        <aside class="builder-panel">
            <div class="builder-header">
                <h2>Your Puzzle</h2>
                <div class="import-controls">
                    <select id="puzzle-select" title="Load from dailyPuzzles.js">
                        <option value="">Existing puzzles...</option>
                    </select>
                    <select id="export-select" title="Load from output folder">
                        <option value="">Exported files...</option>
                    </select>
                </div>
            </div>

            <div class="form-group">
                <label for="puzzle-theme">Theme *</label>
                <input type="text" id="puzzle-theme" placeholder="e.g. 90s Action Classics">
            </div>

            <div class="form-group">
                <label for="puzzle-description">Description</label>
                <input type="text" id="puzzle-description" placeholder="e.g. Explosive hits from the golden age of action">
            </div>

            <div class="puzzle-movies">
                <div class="movies-header">
                    <span>Movies <span id="movie-count">(0)</span></span>
                    <span class="hint">Drag to reorder</span>
                </div>
                <div id="puzzle-movie-list" class="movie-drop-zone"></div>
            </div>

            <div class="builder-options">
                <label class="checkbox-label">
                    <input type="checkbox" id="add-to-database" checked>
                    <span>Add new movies to movies.js</span>
                </label>
            </div>

            <div class="builder-actions">
                <span id="total-count">0 movies</span>
                <button class="btn" id="btn-clear">Clear</button>
                <button class="btn" id="btn-preview">Preview</button>
                <button class="btn" id="btn-export">Export File</button>
                <button class="btn primary" id="btn-save-puzzle">Save Puzzle</button>
            </div>
        </aside>
    </main>

    <!-- Schedule View -->
    <div id="schedule-view" class="view-container" style="display: none;">
        <div class="schedule-panel">
            <div class="schedule-header">
                <h2>Puzzle Schedule</h2>
                <div class="schedule-controls">
                    <button class="btn" id="btn-prev-month">&larr; Prev</button>
                    <span id="schedule-month">January 2026</span>
                    <button class="btn" id="btn-next-month">Next &rarr;</button>
                </div>
            </div>
            <div class="schedule-list" id="schedule-list">
                <!-- Populated by JS -->
            </div>
            <div class="schedule-actions">
                <button class="btn primary" id="btn-save-schedule">Save Schedule</button>
                <span id="schedule-status"></span>
            </div>
        </div>
    </div>

    <!-- Preview Modal -->
    <div id="preview-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Preview Puzzle</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <pre id="preview-json"></pre>
            </div>
            <div class="modal-footer">
                <button class="btn modal-close">Close</button>
                <button class="btn primary" id="btn-copy-js">Copy JS Snippet</button>
            </div>
        </div>
    </div>

    <!-- Export Success Modal -->
    <div id="export-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Export Complete</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body" id="export-result"></div>
            <div class="modal-footer">
                <button class="btn primary modal-close">Done</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
